(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e3134d4"],{1348:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main user-layout-register"},[r("h3",[r("span",[e._v(e._s(e.pageTitle))])]),r("a-form",{ref:"formRegister",attrs:{form:e.form,id:"formRegister"}},[r("a-form-item",{attrs:{"has-feedback":""}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{required:!0,type:"email",message:"请输入邮箱地址"},{validator:e.validateEmail}],validateTrigger:["blur"]}],expression:"[\n          'email',\n          {\n            rules: [\n              { required: true, type: 'email', message: '请输入邮箱地址' },\n              {\n                validator: validateEmail\n              }\n            ],\n            validateTrigger: ['blur']\n          }\n        ]"}],attrs:{size:"large",type:"text",placeholder:"邮箱"}})],1),r("a-popover",{attrs:{placement:"rightTop",trigger:["focus"],getPopupContainer:function(e){return e.parentElement}},model:{value:e.state.passwordLevelChecked,callback:function(t){e.$set(e.state,"passwordLevelChecked",t)},expression:"state.passwordLevelChecked"}},[r("template",{slot:"content"},[r("div",{style:{width:"240px"}},[r("div",{class:["user-register",e.passwordLevelClass]},[e._v(" 强度："),r("span",[e._v(e._s(e.passwordLevelName))])]),r("a-progress",{attrs:{percent:e.state.percent,showInfo:!1,strokeColor:e.passwordLevelColor}}),r("div",{staticStyle:{"margin-top":"10px"}},[r("span",[e._v("请至少输入 6 个字符。请不要使用容易被猜到的密码。")])])],1)]),r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"]}],expression:"[\n            'password',\n            {\n              rules: [\n                { required: true, message: '至少6位密码，区分大小写' },\n                { validator: this.handlePasswordLevel }\n              ],\n              validateTrigger: ['change', 'blur']\n            }\n          ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少6位密码，区分大小写"},on:{click:e.handlePasswordInputClick}})],1)],2),r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password2",{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"]}],expression:"[\n          'password2',\n          {\n            rules: [{ required: true, message: '至少6位密码，区分大小写' }, { validator: this.handlePasswordCheck }],\n            validateTrigger: ['change', 'blur']\n          }\n        ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"}})],1),r("a-row",{attrs:{gutter:16}},[r("a-col",{staticClass:"gutter-row",attrs:{span:16}},[r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:"请输入验证码"}],validateTrigger:"blur"}],expression:"[\n              'captcha',\n              { rules: [{ required: true, message: '请输入验证码' }], validateTrigger: 'blur' }\n            ]"}],attrs:{size:"large",type:"text",placeholder:"验证码"}},[r("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),r("a-col",{staticClass:"gutter-row",attrs:{span:8}},[r("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha.apply(null,arguments)}}})],1)],1),r("a-form-item",[r("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.registerBtn,disabled:e.registerBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[e._v(" "+e._s(e.createBtnTitle)+" ")]),r("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[e._v(" 使用已有账户登录 ")])],1)],1)],1)},s=[],n=r("5530"),i=(r("ac1f"),r("498a"),r("d3b7"),r("432b")),o=r("ca00"),u=r("c24f"),c=r("b775"),l={sendEmailCaptcha:function(e){return Object(c["b"])({url:"/mail/captcha",method:"get",params:e})}},d=l,p=r("5880"),m=r("2ef0"),h=function(e,t,r){t?u["a"].checkEmail(t).then((function(e){e.data?r(new Error("邮箱地址已经被使用")):r()})):r()},f={0:"低",1:"低",2:"中",3:"强"},g={0:"error",1:"error",2:"warning",3:"success"},v={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},b={name:"Register",components:{},mixins:[i["a"]],data:function(){return{form:this.$form.createForm(this),state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},validateEmail:h,registerBtn:!1,socialLoginAuthUser:{}}},computed:{passwordLevelClass:function(){return g[this.state.passwordLevel]},passwordLevelName:function(){return f[this.state.passwordLevel]},passwordLevelColor:function(){return v[this.state.passwordLevel]},pageTitle:function(){return Object(m["isEmpty"])(this.socialLoginAuthUser)?"创建帐号":"第三方帐号未绑定，立即创建帐号完成绑定"},createBtnTitle:function(){return Object(m["isEmpty"])(this.socialLoginAuthUser)?"注册":"创建帐号"}},created:function(){this.socialLoginAuthUser=this.$route.params,this.$log.debug(this.socialLoginAuthUser)},destroyed:function(){this.$log.debug("清空socialLoginAuthUser")},methods:Object(n["a"])(Object(n["a"])({},Object(p["mapActions"])(["SocialSignLogin"])),{},{handlePasswordLevel:function(e,t,r){var a=0;/[0-9]/.test(t)&&a++,/[a-zA-Z]/.test(t)&&a++,/[^0-9a-zA-Z_]/.test(t)&&a++,this.state.passwordLevel=a,this.state.percent=30*a,a>=2?(a>=3&&(this.state.percent=100),r()):(0===a&&(this.state.percent=10),r(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,r){var a=this.form.getFieldValue("password");void 0===t&&r(new Error("请输入密码")),t&&a&&t.trim()!==a.trim()&&r(new Error("两次密码不一致")),r()},handlePasswordInputClick:function(){this.isMobile?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this,t=this.form.validateFields,r=this.state,a=this.$router;t({force:!0},(function(t,s){if(!t)if(r.passwordLevelChecked=!1,e.registerBtn=!0,e.socialLoginAuthUser){var i=Object.assign({},s);e.socialLoginAuthUser.token=null,i.authUser=e.socialLoginAuthUser,e.SocialSignLogin(i).then((function(t){e.registerBtn=!1,e.loginSuccess(t)})).finally((function(){e.registerBtn=!1}))}else a.push({name:"registerResult",params:Object(n["a"])({},s)}),e.registerBtn=!1}))},loginSuccess:function(e){var t=this;this.$router.push({name:"dashboard"}),setTimeout((function(){t.$notification.success({message:"欢迎",description:"".concat(Object(o["b"])(),"，欢迎加入")})}),1e3)},getCaptcha:function(e){e.preventDefault();var t=this.form.validateFields,r=this.state,a=this.$message;t(["email"],{force:!0},(function(e,t){if(!e){r.smsSendBtn=!0;var s=window.setInterval((function(){r.time--<=0&&(r.time=60,r.smsSendBtn=!1,window.clearInterval(s))}),1e3);a.loading("验证码发送中.."),d.sendEmailCaptcha(t).then((function(e){a.success("验证码发送成功")}))}}))},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}}),watch:{"state.passwordLevel":function(e){}}},w=b,C=(r("5d18"),r("14a3"),r("2877")),k=Object(C["a"])(w,a,s,!1,null,"71fb5786",null);t["default"]=k.exports},"14a3":function(e,t,r){"use strict";r("2426")},2426:function(e,t,r){},"432b":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r("5530"),s=r("5880"),n={computed:Object(a["a"])(Object(a["a"])({},Object(s["mapState"])({layout:function(e){return e.app.layout},navTheme:function(e){return e.app.theme},primaryColor:function(e){return e.app.color},colorWeak:function(e){return e.app.weak},fixedHeader:function(e){return e.app.fixedHeader},fixedSidebar:function(e){return e.app.fixedSidebar},contentWidth:function(e){return e.app.contentWidth},autoHideHeader:function(e){return e.app.autoHideHeader},isMobile:function(e){return e.app.isMobile},sideCollapsed:function(e){return e.app.sideCollapsed},multiTab:function(e){return e.app.multiTab}})),{},{isTopMenu:function(){return"topmenu"===this.layout}}),methods:{isSideMenu:function(){return!this.isTopMenu}}}},"5d18":function(e,t,r){"use strict";r("eeab")},c24f:function(e,t,r){"use strict";var a=r("b775"),s={list:function(e){return Object(a["b"])({url:"/user/list",method:"get",params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})},create:function(e){return Object(a["b"])({url:"/user",method:"post",data:e})},update:function(e){return Object(a["b"])({url:"/user",method:"put",data:e})},updateProfile:function(e){return Object(a["b"])({url:"/user/profile",method:"put",data:e})},updateAvatar:function(e){return Object(a["b"])({url:"/user/avatar?avatar=".concat(e),method:"put"})},updatePassword:function(e){return Object(a["b"])({url:"/user/password",method:"put",data:e})},resetPassword:function(e){return Object(a["b"])({url:"/user/reset/".concat(e),method:"put"})},checkUsername:function(e){return Object(a["b"])({url:"/user/check/username",method:"get",params:{username:e}})},checkEmail:function(e){return Object(a["b"])({url:"/user/check/email",method:"get",params:{email:e}})},lockUser:function(e){return Object(a["b"])({url:"/user/lock/".concat(e),method:"put"})},unlockUser:function(e){return Object(a["b"])({url:"/user/unlock/".concat(e),method:"put"})},deleteUser:function(e){return Object(a["b"])({url:"/user",method:"delete",data:e})}};t["a"]=s},eeab:function(e,t,r){}}]);