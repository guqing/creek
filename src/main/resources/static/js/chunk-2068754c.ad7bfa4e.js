(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2068754c"],{"1faf":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:15}},[a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"用户名"}},[a("a-input",{attrs:{placeholder:"用户名"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"用户组"}},[a("a-input",{attrs:{placeholder:"用户组"},model:{value:e.queryParam.userGroup,callback:function(t){e.$set(e.queryParam,"userGroup",t)},expression:"queryParam.userGroup"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"用户状态"}},[a("a-select",{attrs:{placeholder:"请选择","default-value":"0"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},[a("a-select-option",{attrs:{value:"0"}},[e._v("正常")]),a("a-select-option",{attrs:{value:"1"}},[e._v("禁用")])],1)],1)],1),a("a-col",{attrs:{md:5,sm:24}},[a("a-form-item",{attrs:{label:"创建时间"}},[a("a-range-picker",{staticStyle:{width:"100%"},on:{change:e.onDatePickerChange}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",loading:e.loadingState.query},on:{click:e.handleSearch}},[e._v(" 查询 ")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{loading:e.loadingState.reset},on:{click:e.handleSearchReset}},[e._v(" 重置 ")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$refs.modal.add()}}},[e._v(" 新建 ")]),a("a-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.tableOpsVisible,expression:"tableOpsVisible"}]},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1",on:{click:e.handleDeleteInBatch}},[a("a-icon",{attrs:{type:"delete"}}),e._v("删除 ")],1),a("a-menu-item",{key:"2",on:{click:function(t){return e.handleLockUserInBatch()}}},[a("a-icon",{attrs:{type:"lock"}}),e._v("锁定 ")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"username",showPagination:"auto",columns:e.columns,data:e.loadData,alert:{show:!0,clear:!0},rowSelection:e.rowSelection},scopedSlots:e._u([{key:"roleNames",fn:function(t){return e._l(t,(function(t,r){return a("a-tag",{key:r,attrs:{color:e.tagColor(r)}},[e._v(" "+e._s(t)+" ")])}))}},{key:"action",fn:function(t,r){return[a("div",{staticClass:"editable-row-operations"},[a("span",[a("a",{staticClass:"edit",on:{click:function(t){return e.$refs.modal.edit(r)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v(" 更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{attrs:{href:"javascript:;"}},[e._v("详情")])]),0!==r.status||r.isInternal?e._e():a("a-menu-item",{on:{click:function(t){return e.handleLockUser([r.username])}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("锁定")])]),1!==r.status||r.isInternal?e._e():a("a-menu-item",[a("a",{attrs:{href:"javascript:;"},on:{click:e.handleLockUserInBatch}},[e._v("解锁")])]),r.isInternal?e._e():a("a-menu-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.del(r)}}},[e._v(" 删除 ")])]),a("a-menu-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleResetPassword(r)}}},[e._v(" 重置密码 ")])])],1)],1)],1)])]}}])}),a("user-modal",{ref:"modal",on:{ok:e.handleModalOk}})],1)},n=[],s=a("2af9"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"操作",visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}]})],1),a("a-form-item",{attrs:{label:"用户名","has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:e.rules.username,trigger:"blur"}]}],expression:"[\n            'username',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: '请输入用户名',\n                  trigger: 'blur',\n                },\n                {\n                  validator: rules.username,\n                  trigger: 'blur',\n                },\n              ],\n            },\n          ]"}],attrs:{disabled:e.usernameDisable}})],1),a("a-form-item",{attrs:{label:"密码","has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:e.rules.passwordRequired,message:"请输入密码",whitespace:!0},{min:3,message:"字符长度必须大于3"}]}],expression:"[\n            'password',\n            {\n              rules: [\n                {\n                  required: rules.passwordRequired,\n                  message: '请输入密码',\n                  whitespace: true,\n                },\n                { min: 3, message: '字符长度必须大于3' },\n              ],\n            },\n          ]"}]})],1),a("a-form-item",{attrs:{label:"邮箱","has-feedback":""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{validator:e.rules.email,trigger:"blur"}]}],expression:"[\n            'email',\n            {\n              rules: [\n                {\n                  validator: rules.email,\n                  trigger: 'blur',\n                },\n              ],\n            },\n          ]"}]})],1),a("a-form-item",{attrs:{label:"角色"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleIds",{rules:[{required:!0,validator:e.rules.roles}]}],expression:"[\n            'roleIds',\n            {\n              rules: [{ required: true, validator: rules.roles }],\n            },\n          ]"}],staticStyle:{width:"100%"},attrs:{mode:"multiple",placeholder:"选择角色"}},e._l(e.roles,(function(t,r){return a("a-select-option",{key:r,attrs:{value:t.id,label:"roleName"}},[e._v(" "+e._s(t.roleName)+" ")])})),1)],1)],1)],1)],1)},i=[],l=(a("ac1f"),a("d81d"),a("d3b7"),a("cc5e")),c=a("c24f"),u=a("88bc"),d=a.n(u),m=function(e,t,a){t.length<1?a(new Error("请选择角色")):a()},f={name:"UserModal",data:function(){var e=this;return{usernameDisable:!1,rules:{passwordRequired:!0,roles:m,email:function(t,a,r){e.editParam.email===a&&r(),c["a"].checkEmail(a).then((function(e){e.data?r(new Error("邮箱地址已经被使用")):r()})),r()},username:function(t,a,r){/^[A-Za-z0-9]+$/.test(a)?e.editParam.username===a?r():c["a"].checkUsername(a).then((function(e){e.data?r(new Error("用户名已经被使用")):r()})):r(new Error("只能输入字母或数字"))}},roles:[],labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},visible:!1,editParam:{},confirmLoading:!1}},beforeCreate:function(){this.form=this.$form.createForm(this),this.$log.debug("form::",this.form)},created:function(){this.handleRoleList()},methods:{handleRoleList:function(){var e=this;l["a"].options().then((function(t){e.roles=t.data}))},add:function(){this.visible=!0},edit:function(e){var t=this;this.visible=!0,this.usernameDisable=e.isInternal,this.rules.passwordRequired=!1,this.editParam=Object.assign({},e),this.$nextTick((function(){t.form.setFieldsValue(d()(t.editParam,"id","username","password","email"));var a=e.roles.map((function(e){return e.id}))||[];t.form.setFieldsValue({roleIds:a})}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;this.form.validateFields((function(t,a){t||(e.$log.debug("form values",a),e.confirmLoading=!0,a.id?e.handleUpdateUser(a):e.handleCreateUser(a))}))},handleUpdateUser:function(e){var t=this;c["a"].update(e).then((function(e){t.$message.success("更新成功"),t.$emit("ok")})).finally((function(){setTimeout((function(){t.confirmLoading=!1}),1500),t.close()}))},handleCreateUser:function(e){var t=this;c["a"].create(e).then((function(e){t.$message.success("保存成功"),t.$emit("ok")})).finally((function(){setTimeout((function(){t.confirmLoading=!1}),1500),t.close()}))},handleCancel:function(){this.form.resetFields(),this.close()}}},h=f,p=a("2877"),b=Object(p["a"])(h,o,i,!1,null,null,null),g=b.exports,v={name:"UserList",components:{STable:s["i"],UserModal:g},data:function(){var e=this,t=this.$createElement;return{loadingState:{query:!1,reset:!1},rangePicker:null,queryParam:{},pagination:{current:1,pageSize:10,total:0},tagColors:["pink","orange","green","blue","purple"],columns:[{title:"用户名",dataIndex:"username"},{title:"昵称",dataIndex:"nickname"},{title:"性别",dataIndex:"gender",customRender:function(e,a){switch(e){case"0":return t("a-tag",{attrs:{color:"green"}},["男性"]);case"1":return t("a-tag",{attrs:{color:"pink"}},["女性"]);default:return t("a-tag",["保密"])}}},{title:"邮箱",dataIndex:"email",customRender:function(e){return e||"未知"}},{title:"手机号",dataIndex:"mobile",scopedSlots:{customRender:"mobile"},customRender:function(e){return e||"未知"}},{title:"角色",dataIndex:"roleNames",scopedSlots:{customRender:"roleNames"}},{title:"状态",dataIndex:"status",customRender:function(e,t){switch(e){case 0:return"正常";case 1:return"禁用";default:return"禁用"}}},{title:"创建时间",dataIndex:"createTime",sorter:!0,scopedSlots:{customRender:"createTime"}},{table:"操作",title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],loadData:function(t){var a={};return a.current=t.pageNo,a.pageSize=t.pageSize,Object.assign(a,e.queryParam),e.$log.debug("loadData request parameters:",a),c["a"].list(a).then((function(e){return{pageSize:e.data.pageSize,pageNo:e.data.current,totalCount:e.data.total,totalPage:e.data.pages,data:e.data.list}})).catch((function(t){return e.$message.error("查询出错:".concat(t)),{pageSize:0,pageNo:1,totalCount:0,totalPage:0,data:[]}}))},selectedRowKeys:[],selectedRows:[]}},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},tagColor:function(){return function(e){return e>this.tagColors.length?this.tagColors[this.tagColors.length%e]:this.tagColors[e]}},tableOpsVisible:function(){return this.selectedRowKeys.length>0}},methods:{handleChange:function(e,t,a,r){r[a.dataIndex]=e},del:function(e){this.$log.debug("删除用户:",e.username),this.handleDeleteUser("真的要删除用户 ".concat(e.username," 吗?"),[e.username])},handleDeleteInBatch:function(){this.$log.debug("批量删除用户:",this.selectedRowKeys),this.handleDeleteUser("真的要批量删除所选中的用户吗?",this.selectedRowKeys)},handleDeleteUser:function(e,t){var a=this;this.$confirm({title:"警告",content:e,okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){c["a"].deleteUser(t).then((function(e){a.$message.success("删除用户成功"),a.$refs.table.refresh()}))},onCancel:function(){a.$log.info("Cancel")}})},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleSearch:function(){var e=this;this.loadingState.query=!0,this.$log.debug("搜索条件:",this.queryParam),this.$refs.table.refresh(),setTimeout((function(){e.loadingState.query=!1}),1500)},handleSearchReset:function(){var e=this;this.loadingState.reset=!0,this.queryParam={},this.$refs.table.refresh(),setTimeout((function(){e.loadingState.reset=!1}),1500)},onDatePickerChange:function(e,t){this.queryParam.createTimeFrom=t[0],this.queryParam.createTimeTo=t[1]},handleModalOk:function(){this.$log.debug("user create success"),this.$refs.table.refresh()},handleResetPassword:function(e){var t=this;this.$confirm({title:"警告",content:"确定要重置 ".concat(e.nickname," 的密码吗?"),okText:"重置",okType:"danger",cancelText:"取消",onOk:function(){t.$log.debug("重置用户密码",e.username),c["a"].resetPassword(e.username).then((function(e){t.$message.success("重置密码成功")}))},onCancel:function(){t.$log.info("Cancel")}})},handleLockUserInBatch:function(){this.handleLockUser(this.selectedRowKeys)},handleLockUser:function(e){var t=this;this.$confirm({title:"警告",content:"确定要锁定选中的用户吗?",okText:"锁定",okType:"danger",cancelText:"取消",onOk:function(){t.$log.debug("所用用户",e),c["a"].lockUser(e).then((function(e){t.$message.success("锁定用户成功"),t.$refs.table.refresh()}))},onCancel:function(){t.$log.info("Cancel")}})}}},y=v,w=(a("6b40"),Object(p["a"])(y,r,n,!1,null,"19c36813",null));t["default"]=w.exports},"2fe3":function(e,t,a){},"6b40":function(e,t,a){"use strict";a("2fe3")},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,n="[object Arguments]",s="[object Function]",o="[object GeneratorFunction]",i="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,n=Array(r);while(++a<r)n[a]=t(e[a],a,e);return n}function f(e,t){var a=-1,r=t.length,n=e.length;while(++a<r)e[n+a]=t[a];return e}var h=Object.prototype,p=h.hasOwnProperty,b=h.toString,g=u.Symbol,v=h.propertyIsEnumerable,y=g?g.isConcatSpreadable:void 0,w=Math.max;function k(e,t,a,r,n){var s=-1,o=e.length;a||(a=C),n||(n=[]);while(++s<o){var i=e[s];t>0&&a(i)?t>1?k(i,t-1,a,r,n):f(n,i):r||(n[n.length]=i)}return n}function j(e,t){return e=Object(e),O(e,t,(function(t,a){return a in e}))}function O(e,t,a){var r=-1,n=t.length,s={};while(++r<n){var o=t[r],i=e[o];a(i,o)&&(s[o]=i)}return s}function $(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,n=w(a.length-t,0),s=Array(n);while(++r<n)s[r]=a[t+r];r=-1;var o=Array(t+1);while(++r<t)o[r]=a[r];return o[t]=s,d(e,this,o)}}function C(e){return P(e)||x(e)||!!(y&&e&&e[y])}function S(e){if("string"==typeof e||L(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function x(e){return R(e)&&p.call(e,"callee")&&(!v.call(e,"callee")||b.call(e)==n)}var P=Array.isArray;function q(e){return null!=e&&I(e.length)&&!_(e)}function R(e){return T(e)&&q(e)}function _(e){var t=U(e)?b.call(e):"";return t==s||t==o}function I(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function U(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function T(e){return!!e&&"object"==typeof e}function L(e){return"symbol"==typeof e||T(e)&&b.call(e)==i}var N=$((function(e,t){return null==e?{}:j(e,m(k(t,1),S))}));e.exports=N}).call(this,a("c8ba"))},c24f:function(e,t,a){"use strict";var r=a("b775"),n={list:function(e){return Object(r["b"])({url:"/user/list",method:"get",params:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})},create:function(e){return Object(r["b"])({url:"/user",method:"post",data:e})},update:function(e){return Object(r["b"])({url:"/user",method:"put",data:e})},updateProfile:function(e){return Object(r["b"])({url:"/user/profile",method:"put",data:e})},updateAvatar:function(e){return Object(r["b"])({url:"/user/avatar?avatar=".concat(e),method:"put"})},updatePassword:function(e){return Object(r["b"])({url:"/user/password",method:"put",data:e})},resetPassword:function(e){return Object(r["b"])({url:"/user/reset/".concat(e),method:"put"})},checkUsername:function(e){return Object(r["b"])({url:"/user/check/username",method:"get",params:{username:e}})},checkEmail:function(e){return Object(r["b"])({url:"/user/check/email",method:"get",params:{email:e}})},lockUser:function(e){return Object(r["b"])({url:"/user/lock/".concat(e),method:"put"})},unlockUser:function(e){return Object(r["b"])({url:"/user/unlock/".concat(e),method:"put"})},deleteUser:function(e){return Object(r["b"])({url:"/user",method:"delete",data:e})}};t["a"]=n},cc5e:function(e,t,a){"use strict";var r=a("b775"),n={listRole:function(e){return Object(r["b"])({url:"/role/list",method:"get",params:e})},getById:function(e){return Object(r["b"])({url:"/role/".concat(e),method:"get"})},createOrUpdate:function(e){return Object(r["b"])({url:"/role/save",method:"post",data:e})}};n.getById=function(e){return Object(r["b"])({url:"/role/".concat(e),method:"get"})},n.deleteById=function(e){return Object(r["b"])({url:"/role/".concat(e),method:"delete"})},n.options=function(){return Object(r["b"])({url:"/role/options",method:"get"})},t["a"]=n}}]);