(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a3663882"],{"59e4":function(t,e,a){"use strict";var n=a("b775"),o={list:function(t){return Object(n["b"])({url:"/log/action",method:"get",params:t})}};e["a"]=o},"85f2":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:4,sm:24}},[n("a-form-item",{attrs:{label:"操作人"}},[n("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),n("a-col",{attrs:{md:4,sm:24}},[n("a-form-item",{attrs:{label:"操作内容"}},[n("a-input-number",{staticStyle:{width:"100%"},model:{value:e.queryParam.callNo,callback:function(t){e.$set(e.queryParam,"callNo",t)},expression:"queryParam.callNo"}})],1)],1),n("a-col",{attrs:{md:5,sm:24}},[n("a-form-item",{attrs:{label:"操作时间"}},[n("a-range-picker",{staticStyle:{width:"100%"},on:{change:e.onDatePickerChange}})],1)],1),n("a-col",{attrs:{md:4,sm:24}},[n("a-form-item",{attrs:{label:"操作地点"}},[n("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.location,callback:function(t){e.$set(e.queryParam,"location",t)},expression:"queryParam.location"}})],1)],1),n("a-col",{attrs:{md:4,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary"},on:{click:function(t){e.$refs.table.refresh(!0)}}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.resetSearchForm}},[e._v("重置")])],1)])],1)],1)],1),n("div",{staticClass:"table-operator"},[e.selectedRowKeys.length>0?n("a-dropdown",[n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1"},[n("a-icon",{attrs:{type:"delete"}}),e._v("删除")],1)],1),n("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),n("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),n("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:{show:!0,clear:function(){t.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},scopedSlots:e._u([{key:"action",fn:function(t,a){return n("span",{},[[n("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.$refs.modal.detail(a)}}},[e._v("详情")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]],2)}}])}),n("action-modal",{ref:"modal"})],1)},o=[],i=a("2af9"),s=a("59e4"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"日志详情",visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-descriptions",{attrs:{column:1}},[a("a-descriptions-item",{attrs:{label:"操作人"}},[t._v(" "+t._s(t.actionLog.username)+" ")]),a("a-descriptions-item",{attrs:{label:"操作内容"}},[t._v(" "+t._s(t.actionLog.operation)+" ")]),a("a-descriptions-item",{attrs:{label:"方法名"}},[t._v(" "+t._s(t.actionLog.method)+" ")]),a("a-descriptions-item",{attrs:{label:"方法参数"}},[t._v(" "+t._s(t.actionLog.params)+" ")]),a("a-descriptions-item",{attrs:{label:"耗时"}},[t._v(" "+t._s(t.actionLog.executionTime)+" ")]),a("a-descriptions-item",{attrs:{label:"操作IP"}},[t._v(" "+t._s(t.actionLog.ip)+" ")]),a("a-descriptions-item",{attrs:{label:"操作位置"}},[t._v(" "+t._s(t.actionLog.location)+" ")]),a("a-descriptions-item",{attrs:{label:"操作时间"}},[t._v(" "+t._s(t.actionLog.createTime)+" ")])],1)],1)],1)},l=[],c={name:"ActionModel",data:function(){return{visible:!1,confirmLoading:!1,actionLog:{}}},methods:{close:function(){this.$emit("close"),this.visible=!1},detail:function(t){this.visible=!0,this.actionLog=Object.assign({},t)},handleOk:function(){this.actionLog={},this.close()},handleCancel:function(){this.actionLog={},this.close()}}},d=c,u=a("2877"),m=Object(u["a"])(d,r,l,!1,null,null,null),p=m.exports,h={name:"ActionLog",components:{STable:i["i"],ActionModal:p},data:function(){var t=this,e=this.$createElement;return{mdl:{},advanced:!1,queryParam:{},columns:[{title:"操作人",dataIndex:"username"},{title:"内容",dataIndex:"operation",ellipsis:!0},{title:"方法",dataIndex:"method",ellipsis:!0},{title:"入参",dataIndex:"params",ellipsis:!0},{title:"执行耗时",dataIndex:"executionTime",sorter:!0,customRender:function(t){return e("a-tag",{attrs:{color:"green"}},[t," ms"])}},{title:"IP",dataIndex:"ip"},{title:"位置",dataIndex:"location"},{title:"操作时间",dataIndex:"createTime",sorter:!0},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(e){var a={};return a.current=e.pageNo,a.pageSize=e.pageSize,Object.assign(a,t.queryParam),t.$log.debug("loadData.parameter",a),s["a"].list(a).then((function(t){return{pageSize:t.data.pageSize,pageNo:t.data.current,totalCount:t.data.total,totalPage:t.data.pages,data:t.data.list}})).catch((function(e){return t.$message.error("查询出错:".concat(e)),{pageSize:0,pageNo:1,totalCount:0,totalPage:0,data:[]}}))},selectedRowKeys:[],selectedRows:[]}},methods:{onDatePickerChange:function(t,e){this.queryParam.createFrom=e[0],this.queryParam.createTo=e[1]},handleDelete:function(t){this.$log.debug("删除记录:",t)},handleOk:function(){},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){this.queryParam={createFrom:null,createTo:null},this.$refs.table.refresh()}}},f=h,g=Object(u["a"])(f,n,o,!1,null,null,null);e["default"]=g.exports}}]);